
State string ,District string ,Persons bigint, Males bigint,Females bigint,Growthin population int,Rural bigint,Urban bigint,Sexratio int,ScheduledTribepopulation bigint,Personsliteracyrate int,MalesLiteratacyRate int,FemalesLiteracyRate int,Totalworkers bigint,Mainworkers bigint,Marginalworkers bigint,Nonworkers bigint,Religeon1Name string,Religeon1Population bigint,Religeon2Name string,Religeon2Population bigint,Religeon3Name string,Religeon3Population bigint,TotalInhabitedVillages bigint,Drinkingwaterfacilities int ,ElectricityPowerSupply int,Primaryschool int,Medicalfacility int 

create table census(serial int,State string ,District string ,Persons bigint, Males bigint,Females bigint,Growthinpopulation int,Rural bigint,Urban bigint,Sexratio int,ScheduledTribepopulation bigint,Personsliteracyrate int,MalesLiteratacyRate int,FemalesLiteracyRate int,Totalworkers bigint,Mainworkers bigint,Marginalworkers bigint,Nonworkers bigint,Religeon1Name string,Religeon1Population bigint,Religeon2Name string,Religeon2Population bigint,Religeon3Name string,Religeon3Population bigint,TotalInhabitedVillages bigint,Drinkingwaterfacilities int ,ElectricityPowerSupply int,Primaryschool int,Medicalfacility int)ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde' with serdeproperties ("separatorChar" = ",","quoteChar" = "\"") lines terminated by '\n' stored as textfile;


select persons,males,females from census where  district="District Andamans (01), Andaman & Nicobar Islands (35)" or district="District Adilabad (01), Andhra Pradesh (28)" or district="District Rangareddi (06), Andhra Pradesh (28)";


create table census_state(State string ,Persons bigint, Males bigint,Females bigint,Growthinpopulation int,Rural bigint,Urban bigint,Sexratio int,ScheduledTribepopulation bigint,Personsliteracyrate int,MalesLiteratacyRate int,FemalesLiteracyRate int,Totalworkers bigint,Mainworkers bigint,Marginalworkers bigint,Nonworkers bigint,Religeon1Population bigint,Religeon2Population bigint,Religeon3Population bigint,TotalInhabitedVillages bigint,Drinkingwaterfacilities int ,ElectricityPowerSupply int,Primaryschool int,Medicalfacility int);

insert overwrite table census_state select State,SUM(Persons), SUM(Males ),SUM(Females),avg(Growthinpopulation),SUM(Rural),SUM(Urban),AVG(Sexratio),SUM(ScheduledTribepopulation),AVG(Personsliteracyrate),AVG(MalesLiteratacyRate),AVG(FemalesLiteracyRate),SUM(Totalworkers),SUM(Mainworkers),(Marginalworkers),SUM(Nonworkers),SUM(Religeon1Population),SUM(Religeon2Population),SUM(Religeon3Population),SUM(TotalInhabitedVillages),SUM(Drinkingwaterfacilities),SUM(ElectricityPowerSupply),SUM(Primaryschool),SUM(Medicalfacility) from census group by State;  
